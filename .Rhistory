# Load your data
library(lidR)
library(dplyr)
library(ggplot2)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==8, 2, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==9, 3, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==11, 4, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==12, 5, lasdff[,"treeid"])
##
# Install from GitHub
remotes::install_github("DijoG/DiscreteMorseR")
a <- AlphaHull3D::ahull3d(lasdff[,1:3], alpha = .1)
a
# Create package
Rcpp::compileAttributes()
devtools::document()
devtools::document()
devtools::document()
gc()
# Load your data
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==8, 2, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==9, 3, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==11, 4, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==12, 5, lasdff[,"treeid"])
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,4],
alpha = .1
)
titoc::toc()
a
input_truth <- attr(a, "input_truth") # should be a vector or a matrix of 1*x dimensions
face_truth <- attr(a, "face_truth") # should be a matrix of 3*x dimensions
a$vb
input_truth
a
str(input_truth)
str(input_truth)
str(face_truth)
str(a$vb)
a[1:4, 5:10]
a$vb[1:4, 5:10]
table(a$vb[4,])
str(input_truth)
str(face_truth)
str(a$vb)
# Install
devtools::install()
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==8, 2, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==9, 3, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==11, 4, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==12, 5, lasdff[,"treeid"])
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,4],
alpha = .1
)
tictoc::toc()
input_truth <- attr(a, "input_truth") # should be a vector or a matrix of 1*x dimensions
face_truth <- attr(a, "face_truth") # should be a matrix of 3*x dimensions
table(input_truth)
str(face_truth)
remove.packages("ahull3D")
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==8, 2, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==9, 3, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==11, 4, lasdff[,"treeid"])
lasdff[,"treeid"] <- ifelse(lasdff[,"treeid"]==12, 5, lasdff[,"treeid"])
# lasdfff <-as.data.frame(lasdff)
# unique(lasdfff$treeid)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,4],
alpha = .1
)
tictoc::toc()
a
input_truth <- attr(a, "input_truth") # should be a vector or a matrix of 1*x dimensions
face_truth <- attr(a, "face_truth") # should be a matrix of 3*x dimensions
table(input_truth)
str(face_truth)
a$vb
dim(a$vb)
ncol(a$vb)
length(input_truth) == ncol(a$vb)
dim(face_truth) == dim(a$it)
dim(face_truth)
dim(a$it)
dim(lasdff)
# Create package
unlink(c("src/RcppExports.cpp", "R/RcppExports.R"))
# Recompile attributes
Rcpp::compileAttributes()
# Rebuild documentation
devtools::document()
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
trees_filtered$treeid <- case_when(
trees_filtered$treeid == 1 ~ 1L,
trees_filtered$treeid == 8 ~ 2L,
trees_filtered$treeid == 9 ~ 3L,
trees_filtered$treeid == 11 ~ 4L,
trees_filtered$treeid == 12 ~ 5L,
TRUE ~ trees_filtered$treeid
)
pid <- 1:npoints(trees_filtered)  # Use npoints() instead of nrow() for LAS objects
trees_filtered <- add_lasattribute(trees_filtered, pid, "pid", "Unique point ID")
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid", "pid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
dim(lasdff)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,4],
input_truth = lasdff[,5],
alpha = .1
)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,4],
pid = lasdff[,5],
alpha = .1
)
tictoc::toc()
# Create package
unlink(c("src/RcppExports.cpp", "R/RcppExports.R"))
# Recompile attributes
Rcpp::compileAttributes()
# Rebuild documentation
devtools::document()
# Install
devtools::install()
remove.packages("ahull3D")
# Install
devtools::install()
# Import packs
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
trees_filtered$treeid <- case_when(
trees_filtered$treeid == 1 ~ 1L,
trees_filtered$treeid == 8 ~ 2L,
trees_filtered$treeid == 9 ~ 3L,
trees_filtered$treeid == 11 ~ 4L,
trees_filtered$treeid == 12 ~ 5L,
TRUE ~ trees_filtered$treeid
)
pid <- 1:npoints(trees_filtered)  # Use npoints() instead of nrow() for LAS objects
trees_filtered <- add_lasattribute(trees_filtered, pid, "pid", "Unique point ID")
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid", "pid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
dim(lasdff)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
pid = lasdff[,5],
alpha = .1
)
tictoc::toc()
attr(a, "pid")
length(pid) == ncol(a$vb)
a$vb
ncol(a$vb)
length(pid)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
pid = lasdff[,5],
alpha = .1
)
tictoc::toc()
pid <- attr(a, "pid")                 # a vector
face_truth <- attr(a, "face_truth")   # a matrix of 3*x dimensions
face_truth
pid
remove.packages("ahull3D")
remotes::install_github("DijoG/ahull3D")
# Import packs
library(lidR)
library(dplyr)
# Read LAS file
trees <- readLAS("D:/xxx/lasref/12tree_exampleN.las")
trees_filtered <- filter_poi(trees, treeid %in% c(1,8,9,11,12))
trees_filtered$treeid <- case_when(
trees_filtered$treeid == 1 ~ 1L,
trees_filtered$treeid == 8 ~ 2L,
trees_filtered$treeid == 9 ~ 3L,
trees_filtered$treeid == 11 ~ 4L,
trees_filtered$treeid == 12 ~ 5L,
TRUE ~ trees_filtered$treeid
)
pid <- 1:npoints(trees_filtered)  # Use npoints() instead of nrow() for LAS objects
trees_filtered <- add_lasattribute(trees_filtered, pid, "pid", "Unique point ID")
# Extract points
lasdff <- trees_filtered@data[,c("X", "Y", "Z", "treeid", "pid")] %>%
as.data.frame() %>%
distinct(across(1:3), .keep_all = TRUE) %>%
as.matrix()
dim(lasdff)
tictoc::tic()
a <- ahull3D::ahull3d(
points = lasdff[,1:3],
input_truth = lasdff[,5],
alpha = .1
)
tictoc::toc()
input_truth <- attr(a, "input_truth") # a vector
face_truth <- attr(a, "face_truth")   # a matrix of 3*x dimensions
length(input_truth) == ncol(a$vb)     # should be TRUE
input_truth
# Extract largest connected component mesh
mesh <- DiscreteMorseR::get_CCMESH(a)
length(attr(mesh, "input_truth"))
attr(mesh, "input_truth")
meshes <- DiscreteMorseR::get_CCMESH(a, select_largest = F)
mall <- lapply(meshes, function(m) attr(m, "input_truth"))
table(mall[[1]]) == table(attr(mesh, "input_truth"))
